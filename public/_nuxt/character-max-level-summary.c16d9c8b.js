import{_ as B}from"./CommonHeader.26266d53.js";import{u as L,d as w}from"./index.cf8b48e0.js";import{a as S,b as F,e as E,f as G,r as K,h as N,i as P,j as _,k as a,w as l,F as U,l as h,o as i,m as D,p as T,c as k,q as M,t as V,s as $}from"./entry.ebd83981.js";import{d as j}from"./index.d7b1551d.js";import"./composables.2f5ae9e9.js";const I=F({setup(){const t=E(),p=L(),{$constants:m}=G(),v=K({name:{value:null,matchMode:U.IN}}),g=N([]),f=K(m.eachCharacterPageDefaultDisplayKnowhows),d=K(m.eachCharacterPageDefaultDisplayKnowhows);return P(()=>{const s=w(p.unserializedData);m.characters.forEach(c=>{const r=w(j);r.name=c;const u=s.filter(e=>{var o;return((o=e.name)==null?void 0:o.code)===c.code});if(u.length>0){let e=[];u.forEach(o=>{o.knowhows.forEach(n=>{n.knowhow&&n.level&&e.push(w(n))})}),e=e.sort((o,n)=>o.knowhow.code!==n.knowhow.code?o.knowhow.code.localeCompare(n.knowhow.code):n.level.code-o.level.code),r.knowhows=e.reduce((o,n)=>{const C=o[o.length-1];return(!C||C.knowhow.code!==n.knowhow.code)&&o.push(n),o},[])}g.push(r)})}),{filters:v,characterKnowhows:g,displayTargetKnowhows:f,tempDisplayTargetKnowhows:d,displayKnowhow:(s,c)=>{let r=s.find(u=>{var e;return((e=u.knowhow)==null?void 0:e.code)===c.code});return r?r.level.name:null},applyDisplayTargetKnowhows:()=>{d.value.length>=25?t.require({header:"確認",message:"表示対象とするノウハウが多い場合、表示に時間が掛かる場合があります",acceptLabel:"OK",rejectLabel:"キャンセル",acceptIcon:"pi pi-check",rejectIcon:"pi pi-times",accept:()=>{f.value=w(d.value)}}):f.value=w(d.value)}}}}),q={class:"container"},A=$("div",{class:"mb-3 font-bold"},"キャラクター",-1),R=$("span",{class:"p-column-title white-space-nowrap mr-3"},"表示するノウハウ",-1);function z(t,p,m,v,g,f){const d=B,b=h("MultiSelect"),y=h("Button"),s=h("Column"),c=h("Row"),r=h("ColumnGroup"),u=h("DataTable");return i(),_("div",q,[a(d),a(u,{value:t.characterKnowhows,class:"p-datatable-sm mb-4",dataKey:"id",showGridlines:"",sortMode:"multiple",multiSortMeta:[{field:"id",order:1}],responsiveLayout:"scroll",filters:t.filters,"onUpdate:filters":p[1]||(p[1]=e=>t.filters=e),filterDisplay:"menu"},{default:l(()=>[a(r,{type:"header"},{default:l(()=>[a(c,null,{default:l(()=>[a(s,{header:"キャラクター",rowspan:2,sortable:!0,sortField:"name.code",filterField:"name",showFilterMatchModes:!1,filterMenuStyle:{width:"18rem"},class:"white-space-nowrap",style:{width:"130px"}},{filter:l(({filterModel:e})=>[A,a(b,{modelValue:e.value,"onUpdate:modelValue":o=>e.value=o,options:t.$constants.characters,optionLabel:"name",class:"p-column-filter",display:"chip"},null,8,["modelValue","onUpdate:modelValue","options"])]),filterclear:l(({filterCallback:e})=>[a(y,{label:"クリア",type:"button",icon:"pi pi-times",iconPos:"right",class:"p-button-sm p-button-secondary",onClick:o=>e()},null,8,["onClick"])]),filterapply:l(({filterCallback:e})=>[a(y,{label:"適用",type:"button",icon:"pi pi-check",iconPos:"right",class:"p-button-sm p-button-success",onClick:o=>e()},null,8,["onClick"])]),_:1}),a(s,{colspan:t.$constants.flattenKnowhows.length},{header:l(e=>[R,a(b,{modelValue:t.tempDisplayTargetKnowhows,"onUpdate:modelValue":p[0]||(p[0]=o=>t.tempDisplayTargetKnowhows=o),options:t.$constants.knowhows,optionLabel:"name",optionGroupLabel:"name",optionGroupChildren:"items",filter:!0,display:"chip",showToggleAll:!1,class:"mr-3",style:{"max-width":"200px"}},null,8,["modelValue","options"]),a(y,{label:"反映",type:"button",class:"p-button-sm p-button-success white-space-nowrap",onClick:t.applyDisplayTargetKnowhows},null,8,["onClick"])]),_:1},8,["colspan"])]),_:1}),a(c,null,{default:l(()=>[t.displayTargetKnowhows.length?(i(!0),_(D,{key:0},T(t.displayTargetKnowhows,e=>(i(),k(s,{field:e.code,header:e.name,key:e.code,class:"white-space-nowrap"},null,8,["field","header"]))),128)):(i(),k(s,{key:1}))]),_:1})]),_:1}),a(s,{field:"name",header:"キャラクター"},{body:l(e=>{var o;return[M(V((o=e.data.name)==null?void 0:o.name),1)]}),_:1}),t.displayTargetKnowhows.length?(i(!0),_(D,{key:0},T(t.displayTargetKnowhows,(e,o)=>(i(),k(s,{field:"knowhow"+o,header:e.name,class:"text-center"},{body:l(n=>[M(V(t.displayKnowhow(n.data.knowhows,e)),1)]),_:2},1032,["field","header"]))),256)):(i(),k(s,{key:1}))]),_:1},8,["value","filters"])])}const X=S(I,[["render",z]]);export{X as default};
